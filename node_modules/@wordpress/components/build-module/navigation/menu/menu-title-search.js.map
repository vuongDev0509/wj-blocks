{"version":3,"sources":["@wordpress/components/src/navigation/menu/menu-title-search.js"],"names":["filter","useEffect","useRef","__","_n","sprintf","ESCAPE","withSpokenMessages","useNavigationMenuContext","useNavigationContext","MenuTitleSearchUI","SEARCH_FOCUS_DELAY","MenuTitleSearch","debouncedSpeak","onCloseSearch","onSearch","search","title","navigationTree","items","menu","inputRef","delayedFocus","setTimeout","current","focus","clearTimeout","count","length","resultsFoundMessage","onClose","onKeyDown","event","keyCode","defaultPrevented","preventDefault","inputId","placeholder","toLowerCase","trim","value"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { filter } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { useEffect, useRef } from '@wordpress/element';\nimport { __, _n, sprintf } from '@wordpress/i18n';\nimport { ESCAPE } from '@wordpress/keycodes';\n\n/**\n * Internal dependencies\n */\nimport withSpokenMessages from '../../higher-order/with-spoken-messages';\nimport { useNavigationMenuContext } from './context';\nimport { useNavigationContext } from '../context';\nimport { MenuTitleSearchUI } from '../styles/navigation-styles';\nimport { SEARCH_FOCUS_DELAY } from '../constants';\n\nfunction MenuTitleSearch( {\n\tdebouncedSpeak,\n\tonCloseSearch,\n\tonSearch,\n\tsearch,\n\ttitle,\n} ) {\n\tconst {\n\t\tnavigationTree: { items },\n\t} = useNavigationContext();\n\tconst { menu } = useNavigationMenuContext();\n\tconst inputRef = useRef();\n\n\t// Wait for the slide-in animation to complete before autofocusing the input.\n\t// This prevents scrolling to the input during the animation.\n\tuseEffect( () => {\n\t\tconst delayedFocus = setTimeout( () => {\n\t\t\tinputRef.current.focus();\n\t\t}, SEARCH_FOCUS_DELAY );\n\n\t\treturn () => {\n\t\t\tclearTimeout( delayedFocus );\n\t\t};\n\t}, [] );\n\n\tuseEffect( () => {\n\t\tif ( ! search ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst count = filter( items, '_isVisible' ).length;\n\t\tconst resultsFoundMessage = sprintf(\n\t\t\t/* translators: %d: number of results. */\n\t\t\t_n( '%d result found.', '%d results found.', count ),\n\t\t\tcount\n\t\t);\n\t\tdebouncedSpeak( resultsFoundMessage );\n\t}, [ items, search ] );\n\n\tconst onClose = () => {\n\t\tonSearch( '' );\n\t\tonCloseSearch();\n\t};\n\n\tfunction onKeyDown( event ) {\n\t\tif ( event.keyCode === ESCAPE && ! event.defaultPrevented ) {\n\t\t\tevent.preventDefault();\n\t\t\tonClose();\n\t\t}\n\t}\n\n\tconst inputId = `components-navigation__menu-title-search-${ menu }`;\n\tconst placeholder = sprintf(\n\t\t/* translators: placeholder for menu search box. %s: menu title */\n\t\t__( 'Search %s' ),\n\t\ttitle?.toLowerCase()\n\t).trim();\n\n\treturn (\n\t\t<div className=\"components-navigation__menu-title-search\">\n\t\t\t<MenuTitleSearchUI\n\t\t\t\tautoComplete=\"off\"\n\t\t\t\tclassName=\"components-navigation__menu-search-input\"\n\t\t\t\tid={ inputId }\n\t\t\t\tonChange={ ( value ) => onSearch( value ) }\n\t\t\t\tonKeyDown={ onKeyDown }\n\t\t\t\tplaceholder={ placeholder }\n\t\t\t\tonClose={ onClose }\n\t\t\t\tref={ inputRef }\n\t\t\t\ttype=\"search\"\n\t\t\t\tvalue={ search }\n\t\t\t/>\n\t\t</div>\n\t);\n}\n\nexport default withSpokenMessages( MenuTitleSearch );\n"]}