{"version":3,"sources":["@wordpress/components/src/form-token-field/suggestions-list.js"],"names":["map","scrollView","classnames","useState","withSafeTimeout","useRefEffect","emptyList","Object","freeze","handleMouseDown","e","preventDefault","SuggestionsList","selectedIndex","scrollIntoView","match","onHover","onSelect","suggestions","displayTransform","instanceId","setTimeout","scrollingIntoView","setScrollingIntoView","listRef","listNode","children","onlyScrollIfNeeded","handleHover","suggestion","handleClick","computeSuggestionMatch","matchText","toLocaleLowerCase","length","indexOfMatch","indexOf","suggestionBeforeMatch","substring","suggestionMatch","suggestionAfterMatch","index","className","value"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport { map } from 'lodash';\nimport scrollView from 'dom-scroll-into-view';\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { useState } from '@wordpress/element';\nimport { withSafeTimeout, useRefEffect } from '@wordpress/compose';\n\nconst emptyList = Object.freeze( [] );\n\nconst handleMouseDown = ( e ) => {\n\t// By preventing default here, we will not lose focus of <input> when clicking a suggestion.\n\te.preventDefault();\n};\n\nfunction SuggestionsList( {\n\tselectedIndex,\n\tscrollIntoView,\n\tmatch = '',\n\tonHover,\n\tonSelect,\n\tsuggestions = emptyList,\n\tdisplayTransform,\n\tinstanceId,\n\tsetTimeout,\n} ) {\n\tconst [ scrollingIntoView, setScrollingIntoView ] = useState( false );\n\n\tconst listRef = useRefEffect(\n\t\t( listNode ) => {\n\t\t\t// only have to worry about scrolling selected suggestion into view\n\t\t\t// when already expanded.\n\t\t\tif (\n\t\t\t\tselectedIndex > -1 &&\n\t\t\t\tscrollIntoView &&\n\t\t\t\tlistNode.children[ selectedIndex ]\n\t\t\t) {\n\t\t\t\tsetScrollingIntoView( true );\n\t\t\t\tscrollView( listNode.children[ selectedIndex ], listNode, {\n\t\t\t\t\tonlyScrollIfNeeded: true,\n\t\t\t\t} );\n\t\t\t\tsetTimeout( () => {\n\t\t\t\t\tsetScrollingIntoView( false );\n\t\t\t\t}, 100 );\n\t\t\t}\n\t\t},\n\t\t[ selectedIndex, scrollIntoView ]\n\t);\n\n\tconst handleHover = ( suggestion ) => {\n\t\treturn () => {\n\t\t\tif ( ! scrollingIntoView ) {\n\t\t\t\tonHover?.( suggestion );\n\t\t\t}\n\t\t};\n\t};\n\n\tconst handleClick = ( suggestion ) => {\n\t\treturn () => {\n\t\t\tonSelect?.( suggestion );\n\t\t};\n\t};\n\n\tconst computeSuggestionMatch = ( suggestion ) => {\n\t\tconst matchText = displayTransform( match || '' ).toLocaleLowerCase();\n\t\tif ( matchText.length === 0 ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tsuggestion = displayTransform( suggestion );\n\t\tconst indexOfMatch = suggestion\n\t\t\t.toLocaleLowerCase()\n\t\t\t.indexOf( matchText );\n\n\t\treturn {\n\t\t\tsuggestionBeforeMatch: suggestion.substring( 0, indexOfMatch ),\n\t\t\tsuggestionMatch: suggestion.substring(\n\t\t\t\tindexOfMatch,\n\t\t\t\tindexOfMatch + matchText.length\n\t\t\t),\n\t\t\tsuggestionAfterMatch: suggestion.substring(\n\t\t\t\tindexOfMatch + matchText.length\n\t\t\t),\n\t\t};\n\t};\n\n\t// We set `tabIndex` here because otherwise Firefox sets focus on this\n\t// div when tabbing off of the input in `TokenField` -- not really sure\n\t// why, since usually a div isn't focusable by default\n\t// TODO does this still apply now that it's a <ul> and not a <div>?\n\treturn (\n\t\t<ul\n\t\t\tref={ listRef }\n\t\t\tclassName=\"components-form-token-field__suggestions-list\"\n\t\t\tid={ `components-form-token-suggestions-${ instanceId }` }\n\t\t\trole=\"listbox\"\n\t\t>\n\t\t\t{ map( suggestions, ( suggestion, index ) => {\n\t\t\t\tconst matchText = computeSuggestionMatch( suggestion );\n\t\t\t\tconst className = classnames(\n\t\t\t\t\t'components-form-token-field__suggestion',\n\t\t\t\t\t{\n\t\t\t\t\t\t'is-selected': index === selectedIndex,\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\t/* eslint-disable jsx-a11y/click-events-have-key-events */\n\t\t\t\treturn (\n\t\t\t\t\t<li\n\t\t\t\t\t\tid={ `components-form-token-suggestions-${ instanceId }-${ index }` }\n\t\t\t\t\t\trole=\"option\"\n\t\t\t\t\t\tclassName={ className }\n\t\t\t\t\t\tkey={\n\t\t\t\t\t\t\tsuggestion?.value\n\t\t\t\t\t\t\t\t? suggestion.value\n\t\t\t\t\t\t\t\t: displayTransform( suggestion )\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonMouseDown={ handleMouseDown }\n\t\t\t\t\t\tonClick={ handleClick( suggestion ) }\n\t\t\t\t\t\tonMouseEnter={ handleHover( suggestion ) }\n\t\t\t\t\t\taria-selected={ index === selectedIndex }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ matchText ? (\n\t\t\t\t\t\t\t<span aria-label={ displayTransform( suggestion ) }>\n\t\t\t\t\t\t\t\t{ matchText.suggestionBeforeMatch }\n\t\t\t\t\t\t\t\t<strong className=\"components-form-token-field__suggestion-match\">\n\t\t\t\t\t\t\t\t\t{ matchText.suggestionMatch }\n\t\t\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t\t\t{ matchText.suggestionAfterMatch }\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\tdisplayTransform( suggestion )\n\t\t\t\t\t\t) }\n\t\t\t\t\t</li>\n\t\t\t\t);\n\t\t\t\t/* eslint-enable jsx-a11y/click-events-have-key-events */\n\t\t\t} ) }\n\t\t</ul>\n\t);\n}\n\nexport default withSafeTimeout( SuggestionsList );\n"]}